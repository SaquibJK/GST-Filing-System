<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head', {title: "Excel Operations" }) %>
</head>
<style>
    /* Table Styles */
    table {
        width: 100%;
        border-collapse: collapse;
        padding: 2rem;
    }

    th,
    td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #f2f2f2;
        font-weight: bold;
    }

    /* Alternating Row Colors */
    tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    /* Hover Effect */
    tr:hover {
        background-color: #e5e5e5;
    }

    /* Form Styles */
    .form-container {
        margin-top: 20px;
        padding: 2rem;
    }

    .form-group {
        display: inline-block;
        margin-right: 10px;
    }

    .form-group label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .form-group select,
    .form-group input {
        padding: 5px;
        width: 150px;
    }

    .form-group .btn {
        padding: 5px 10px;
        background-color: #4caf50;
        color: white;
        border: none;
        cursor: pointer;
    }

    .form-group .dash{
        background-color: #219fe7 !important;
    }

</style>


<body>
 <div class="form-container">
    <div class="form-group">
        <label for="column-select">Select Column:</label>
        <select id="column-select">
            <% Object.keys(data[0]).forEach((key)=> { %>
                <option value="<%= key %>">
                    <%= key %>
                </option>
                <% }); %>
        </select>
    </div>

    <div class="form-group">
        <label for="row-select">Select Row:</label>
        <select id="row-select">
            <% data.forEach((item, index)=> { %>
                <option value="<%= index %>">
                    <%= index + 1 %>
                </option>
                <% }); %>
        </select>
    </div>

    <div class="form-group">
        <label for="formula-input">Formula:</label>
        <input type="text" id="formula-input" placeholder="Enter formula">
    </div>

    <div class="form-group">
        <button class="btn" onclick="applyFormula()">Apply Formula</button>
    </div>

    <div class="form-group">
        <a href="/admin/dashboard" class="btn dash">Back to Dashboard</a>
    </div>
</div>

<table id="data-table">
    <thead>
        <tr>
            <% Object.keys(data[0]).forEach((key)=> { %>
                <th>
                    <%= key %>
                </th>
                <% }); %>
        </tr>
    </thead>
    <tbody>
        <% data.forEach((item)=> { %>
            <tr>
                <% Object.values(item).forEach((value)=> { %>
                    <td>
                        <%= value %>
                    </td>
                    <% }); %>
            </tr>
            <% }); %>
    </tbody>
</table>

<script>
    function applyFormula() {
        const columnSelect = document.getElementById('column-select');
        const rowSelect = document.getElementById('row-select');
        const formulaInput = document.getElementById('formula-input');

        const selectedColumn = columnSelect.value;
        const selectedRow = rowSelect.value;
        const formula = formulaInput.value;

        // Apply the formula to the corresponding field in the table
        const table = document.getElementById('data-table');
        const cell = table.rows[Number(selectedRow) + 1].cells[columnSelect.selectedIndex];
        cell.textContent = evaluateFormula(formula, selectedColumn, selectedRow);
    }

    function evaluateFormula(formula, column, row) {
        // Implement your logic to evaluate the formula based on the selected column and row
        // You can use libraries like math.js or write custom code to handle different formulas
        // Return the computed result of the formula
        // Example: If the formula is 'SUM', calculate the sum of values in the selected column and row
        // Replace the below code with your own formula evaluation logic
        return 'Formula result';
    }
</script>
</body>

</html>